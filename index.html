<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Simple Gantt</title>
    <style>
      body {
        font-family: sans-serif;
        background: #ccc;
      }
      .container {
        width: 80%;
        margin: 0 auto;
      }
      .gantt .bar-milestone .bar {
        fill: tomato;
      }
      .heading {
        text-align: center;
      }
      .gantt-target.dark {
        background-color: #252525;
      }
      /* Add styles for the form */
      .form-container {
        margin: 20px 0;
        text-align: center;
      }
      .form-container input, .form-container button {
        margin: 5px;
      }
    </style>
    <link rel="stylesheet" href="dist/frappe-gantt.css" />
    <script src="dist/frappe-gantt.js"></script>
  </head>
  <body>
    <div class="container">
      <h2 class="heading">Interactive Gantt Chart entirely made in SVG!</h2>
      <div class="form-container">
        <input type="text" id="task-name" placeholder="Task Name" />
        <input type="date" id="task-start" />
        <input type="date" id="task-end" />
        <input type="number" id="task-progress" placeholder="Progress" />
        <button id="add-task">Add Task</button>
      </div>
      <div class="gantt-target"></div>
    </div>
    <script>
      let tasks = [
        {
          start: '2024-04-01',
          end: '2024-04-01',
          name: 'Redesign website',
          id: "Task 0",
          progress: 30
        },
        {
          start: '2024-03-26',
          duration: '6d',
          name: 'Write new content',
          id: "Task 1",
          progress: 5,
          important: true
        },
        {
          start: '2024-04-04',
          end: '2024-04-08',
          name: 'Apply new styles',
          id: "Task 2",
          progress: 80,
          dependencies: 'Task 1'
        },
        {
          start: '2024-04-08',
          end: '2024-04-09',
          name: 'Review',
          id: "Task 3",
          progress: 5,
          dependencies: 'Task 2'
        },
        {
          start: '2024-04-08',
          end: '2024-04-10',
          name: 'Deploy',
          id: "Task 4",
          progress: 0,
        },
        {
          start: '2024-04-21',
          end: '2024-04-29',
          name: 'Go Live!',
          id: "Task 5",
          progress: 0,
          dependencies: 'Task 2',
          custom_class: 'bar-milestone'
        }
      ];

      let gantt_chart = new Gantt(".gantt-target", tasks, {
        on_click: (task) => {
          console.log("Click", task);
        },
        view_mode: "Day",
        view_mode_padding: { DAY: "7d" },
        popup: false,
      });

      function addTask() {
        const name = document.getElementById('task-name').value;
        const start = document.getElementById('task-start').value;
        const end = document.getElementById('task-end').value;
        const progress = parseInt(document.getElementById('task-progress').value, 10);
        console.log(name);
        if (name && start && end && !isNaN(progress)) {
          const newTask = {
            start: start,
            end: end,
            name: name,
            id: `Task ${tasks.length}`,
            progress: progress
          };
          
          tasks.push(newTask);
          gantt_chart = new Gantt(".gantt-target", tasks, {
            on_click: (task) => {
              console.log("Click", task);
            },
            view_mode: "Day",
            view_mode_padding: { DAY: "7d" },
            popup: false,
          });
        }
      }

      document.getElementById('add-task').addEventListener('click', addTask);
    </script>
  </body>
</html>
